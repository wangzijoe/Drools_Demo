<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 5. The Java Rule Engine API (JSR94)</title><link rel="stylesheet" href="css/jbossorg.css" type="text/css"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL-NS Stylesheets V1.74.0"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="home" href="index.html" title="Drools Expert User Guide"/><link rel="up" href="index.html" title="Drools Expert User Guide"/><link rel="prev" href="ch04.html" title="Chapter 4. Rule Language Reference"/><link rel="next" href="ch06.html" title="Chapter 6. The Rule IDE (Eclipse)"/></head><body><p xmlns:d="http://docbook.org/ns/docbook" id="title"><a href="http://www.jboss.org" class="site_href"><strong>JBoss.org</strong></a><a href="http://docs.jboss.org/" class="doc_href"><strong>Community Documentation</strong></a></p><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="ch04.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="ch06.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e8143"/>Chapter 5. The Java Rule Engine API (JSR94)</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="ch05.html#d0e8146">5.1. Introduction</a></span></dt><dt><span class="section"><a href="ch05.html#d0e8161">5.2. How To Use</a></span></dt><dd><dl><dt><span class="section"><a href="ch05.html#d0e8166">5.2.1. Building and Registering RuleExecutionSets</a></span></dt><dt><span class="section"><a href="ch05.html#d0e8199">5.2.2. Using Stateful and Stateless RuleSessions</a></span></dt></dl></dd><dt><span class="section"><a href="ch05.html#d0e8234">5.3. References</a></span></dt></dl></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e8146"/>5.1. Introduction</h2></div></div></div><p>
    Drools provides an implementation of the Java Rule Engine API (known
    as JSR94), which allows for support of multiple rule engines from a
    single API. JSR94 does not deal in any way with the rule language
                itself. W3C is working on the
    <a class="ulink" href="http://www.w3.org/TR/2006/WD-rif-ucr-20060323/">Rule Interchange Format (RIF)</a>
    and the OMG has started to work on a standard based on
    <a class="ulink" href="http://ruleml.org/">RuleML</a>.
    Recently Haley Systems has also proposed a rule language standard
                called RML.
  </p><p>It should be remembered that the JSR94 standard represents the "least
    common denominator" in features across rule engines. This means that
                there is less functionality in the JSR94 API than in the standard
                Knowledge (Drools and jBPM) API. So, by using JSR94, you forfeit the advantage of using the
    full capabilities of the Drools Rule Engine. It is necessary to expose
    further functionality, like globals and support for DRL, DSL and XML,
    via property maps due to the very basic feature set of JSR94; this
                introduces non-portable functionality. Furthermore, as JSR94 does not
                provide a rule language, you are only solving a small fraction of the
                complexity of switching rule engines with very little gain. So, while
                we support JSR94, for those that insist on using it, we strongly
                recommend you program against the Knowledge (Drools and jBPM) API.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e8161"/>5.2. How To Use</h2></div></div></div><p>There are two parts to working with JSR94. The first part is the
  administrative API that deals with building and registering RuleExecutionSet objects,
  the second part is runtime session execution of these RuleExecutionSets.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e8166"/>5.2.1. Building and Registering RuleExecutionSets</h3></div></div></div><p>The RuleServiceProviderManager manages the registration and
    retrieval of RuleServiceProviders. The Drools RuleServiceProvider
    implementation is automatically registered via a static block when the
    class is loaded using Class.forName, in much the same way as JDBC
    drivers.</p><div class="example"><a id="d0e8171"/><p class="title"><b>Example 5.1. Automatic RuleServiceProvider Registration</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">RuleServiceProviderImpl</span><!-- <br/> --><span class="java_plain">&nbsp;is&nbsp;registered&nbsp;to&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;http://drools.org/&quot;</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;via&nbsp;a&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;initialization&nbsp;block</span>
<!--  --><br/><span class="java_type">Class</span><span class="java_separator">.</span><span class="java_plain">forName</span><span class="java_separator">(</span><span class="java_literal">&quot;org.drools.jsr94.rules.RuleServiceProviderImpl&quot;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Get</span><span class="java_plain">&nbsp;the&nbsp;rule&nbsp;service&nbsp;provider&nbsp;from&nbsp;the&nbsp;provider&nbsp;manager</span><span class="java_separator">.</span>
<!--  --><br/><span class="java_type">RuleServiceProvider</span><span class="java_plain">&nbsp;ruleServiceProvider&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">RuleServiceProviderManager</span><span class="java_separator">.</span><span class="java_plain">getRuleServiceProvider</span><span class="java_separator">(</span><span class="java_literal">&quot;http://drools.org/&quot;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>The RuleServiceProvider provides access to the RuleRuntime and
    RuleAdministrator APIs. The RuleAdministrator provides an administration
    API for the management of RuleExecutionSet objects, making it possible to
    register a RuleExecutionSet that can then be retrieved via the
    RuleRuntime.</p><p>First, you need to create a RuleExecutionSet before it can be
    registered; RuleAdministrator provides factory methods to return an empty
    LocalRuleExecutionSetProvider or RuleExecutionSetProvider. The
    LocalRuleExecutionSetProvider should be used to load a RuleExecutionSets
    from local sources that are not serializable, like Streams. The
    RuleExecutionSetProvider can be used to load RuleExecutionSets from
    serializable sources, like DOM Elements or Packages. Both the
    "ruleAdministrator.getLocalRuleExecutionSetProvider( null );" and the
    "ruleAdministrator.getRuleExecutionSetProvider( null );" take null as a
    parameter, as the properties map for these methods is not currently
    used.</p><div class="example"><a id="d0e8180"/><p class="title"><b>Example 5.2. Registering a LocalRuleExecutionSet with the RuleAdministrator
      API</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Get</span><!-- <br/> --><span class="java_plain">&nbsp;the&nbsp;</span><!-- <br/> --><span class="java_type">RuleAdministration</span>
<!--  --><br/><span class="java_type">RuleAdministrator</span><span class="java_plain">&nbsp;ruleAdministrator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;ruleServiceProvider</span><span class="java_separator">.</span><span class="java_plain">getRuleAdministrator</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">LocalRuleExecutionSetProvider</span><span class="java_plain">&nbsp;ruleExecutionSetProvider&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleAdministrator</span><span class="java_separator">.</span><span class="java_plain">getLocalRuleExecutionSetProvider</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Create</span><span class="java_plain">&nbsp;a&nbsp;</span><span class="java_type">Reader</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;drl</span>
<!--  --><br/><span class="java_plain">URL&nbsp;drlUrl&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;URL</span><span class="java_separator">(</span><span class="java_literal">&quot;http://mydomain.org/sources/myrules.drl&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Reader</span><span class="java_plain">&nbsp;drlReader&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">InputStreamReader</span><span class="java_separator">(</span><span class="java_plain">&nbsp;&nbsp;drlUrl</span><span class="java_separator">.</span><span class="java_plain">openStream</span><span class="java_separator">()</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Create</span><span class="java_plain">&nbsp;the&nbsp;</span><span class="java_type">RuleExecutionSet</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;drl</span>
<!--  --><br/><span class="java_type">RuleExecutionSet</span><span class="java_plain">&nbsp;ruleExecutionSet&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleExecutionSetProvider</span><span class="java_separator">.</span><span class="java_plain">createRuleExecutionSet</span><span class="java_separator">(</span><span class="java_plain">&nbsp;drlReader</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</pre></div></div><br class="example-break"/><p>"ruleExecutionSetProvider.createRuleExecutionSet( reader, null )" in
    the above example takes a null parameter for the properties map; however
    it can actually be used to provide configuration for the incoming source.
    When null is passed the default is used to load the input as a drl.
    Allowed keys for a map are "source" and "dsl". The key "source" takes "drl" or
    "xml" as its value; you set "source" to "drl" to load a DRL, or to "xml" to
    load an XML source; "xml" will ignore any "dsl" key/value settings. The
    "dsl" key can take a Reader or a String (the contents of the dsl) as a
    value.</p><div class="example"><a id="d0e8187"/><p class="title"><b>Example 5.3. Specifying a DSL when registering a LocalRuleExecutionSet</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Get</span><!-- <br/> --><span class="java_plain">&nbsp;the&nbsp;</span><!-- <br/> --><span class="java_type">RuleAdministration</span>
<!--  --><br/><span class="java_type">RuleAdministration</span><span class="java_plain">&nbsp;ruleAdministrator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;ruleServiceProvider</span><span class="java_separator">.</span><span class="java_plain">getRuleAdministrator</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">LocalRuleExecutionSetProvider</span><span class="java_plain">&nbsp;ruleExecutionSetProvider&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleAdministrator</span><span class="java_separator">.</span><span class="java_plain">getLocalRuleExecutionSetProvider</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Create</span><span class="java_plain">&nbsp;a&nbsp;</span><span class="java_type">Reader</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;drl</span>
<!--  --><br/><span class="java_plain">URL&nbsp;drlUrl&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;URL</span><span class="java_separator">(</span><span class="java_literal">&quot;http://mydomain.org/sources/myrules.drl&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Reader</span><span class="java_plain">&nbsp;drlReader&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">InputStreamReader</span><span class="java_separator">(</span><span class="java_plain">&nbsp;&nbsp;drlUrl</span><span class="java_separator">.</span><span class="java_plain">openStream</span><span class="java_separator">()</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Create</span><span class="java_plain">&nbsp;a&nbsp;</span><span class="java_type">Reader</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;dsl&nbsp;and&nbsp;a&nbsp;put&nbsp;in&nbsp;the&nbsp;properties&nbsp;map</span>
<!--  --><br/><span class="java_plain">URL&nbsp;dslUrl&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;URL</span><span class="java_separator">(</span><span class="java_literal">&quot;http://mydomain.org/sources/myrules.dsl&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Reader</span><span class="java_plain">&nbsp;dslReader&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">InputStreamReader</span><span class="java_separator">(</span><span class="java_plain">&nbsp;dslUrl</span><span class="java_separator">.</span><span class="java_plain">openStream</span><span class="java_separator">()</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Map</span><span class="java_plain">&nbsp;properties&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">HashMap</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">properties</span><span class="java_separator">.</span><span class="java_plain">put</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;source&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;drl&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">properties</span><span class="java_separator">.</span><span class="java_plain">put</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;dsl&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;dslReader&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Create</span><span class="java_plain">&nbsp;the&nbsp;</span><span class="java_type">RuleExecutionSet</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;drl&nbsp;and&nbsp;dsl</span>
<!--  --><br/><span class="java_type">RuleExecutionSet</span><span class="java_plain">&nbsp;ruleExecutionSet&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleExecutionSetProvider</span><span class="java_separator">.</span><span class="java_plain">createRuleExecutionSet</span><span class="java_separator">(</span><span class="java_plain">&nbsp;reader</span><span class="java_separator">,</span><span class="java_plain">&nbsp;properties&nbsp;</span><span class="java_separator">);</span>
</pre></div></div><br class="example-break"/><p>When registering a RuleExecutionSet you must specify the name to be
    used for its retrieval. There is also a field to pass properties, which is
    currently unused - so just pass null.</p><div class="example"><a id="d0e8194"/><p class="title"><b>Example 5.4. Register the RuleExecutionSet</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Register</span><!-- <br/> --><span class="java_plain">&nbsp;the&nbsp;</span><!-- <br/> --><span class="java_type">RuleExecutionSet</span><!-- <br/> --><span class="java_plain">&nbsp;with&nbsp;the&nbsp;</span><!-- <br/> --><span class="java_type">RuleAdministrator</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;uri&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;ruleExecutionSet</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">ruleAdministrator</span><span class="java_separator">.</span><span class="java_plain">registerRuleExecutionSet</span><span class="java_separator">(</span><span class="java_plain">uri</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ruleExecutionSet</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e8199"/>5.2.2. Using Stateful and Stateless RuleSessions</h3></div></div></div><p>The Runtime, obtained from the RuleServiceProvider, is used to
    create stateful and stateless rule engine sessions.</p><div class="example"><a id="d0e8204"/><p class="title"><b>Example 5.5. Getting the RuleRuntime</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">RuleRuntime</span><!-- <br/> --><span class="java_plain">&nbsp;ruleRuntime&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;ruleServiceProvider</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getRuleRuntime</span><!-- <br/> --><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>To create a rule session you must use one of the two RuleRuntime
    public constants. These are "RuleRuntime.STATEFUL_SESSION_TYPE" and
    "RuleRuntime.STATELESS_SESSION_TYPE", accompanying the URI to the
    RuleExecutionSet you wish to instantiate a RuleSession for. The properties
    map can be null, or it can be used to specify globals, as shown in the
    next section. The createRuleSession(...) method returns a RuleSession
    instance which must then be cast to StatefulRuleSession or
    StatelessRuleSession.</p><div class="example"><a id="d0e8211"/><p class="title"><b>Example 5.6. Stateful Rule</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">StatefulRuleSession</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;session&nbsp;</span><!-- <br/> --><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleRuntime</span><span class="java_separator">.</span><span class="java_plain">createRuleSession</span><span class="java_separator">(</span><span class="java_plain">&nbsp;uri</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">RuleRuntime</span><span class="java_separator">.</span><span class="java_plain">STATEFUL_SESSION_TYPE&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">session</span><span class="java_separator">.</span><span class="java_plain">addObject</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">PurchaseOrder</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;lots&nbsp;of&nbsp;cheese&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">session</span><span class="java_separator">.</span><span class="java_plain">executeRules</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>The StatelessRuleSession has a very simple API; you can only call
    executeRules(List list) passing a list of objects, and an optional filter,
    the resulting objects are then returned.</p><div class="example"><a id="d0e8218"/><p class="title"><b>Example 5.7. Stateless</b></p><div class="example-contents"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">StatelessRuleSession</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;session&nbsp;</span><!-- <br/> --><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;ruleRuntime</span><span class="java_separator">.</span><span class="java_plain">createRuleSession</span><span class="java_separator">(</span><span class="java_plain">&nbsp;uri</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">RuleRuntime</span><span class="java_separator">.</span><span class="java_plain">STATELESS_SESSION_TYPE&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;list&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">list</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">PurchaseOrder</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;even&nbsp;more&nbsp;cheese&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;results&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">results&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;session</span><span class="java_separator">.</span><span class="java_plain">executeRules</span><span class="java_separator">(</span><span class="java_plain">&nbsp;list&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e8223"/>5.2.2.1. Globals</h4></div></div></div><p>It is possible to support globals with JSR94, in a manner that is
      not portable, by using the properties map passed to the RuleSession factory
      method. Globals must be defined in the DRL or XML file first, otherwise
      an exception will be thrown. The key represents the identifier declared
      in the DRL or XML, and the value is the instance you wish to be used in
      the execution. In the following example the results are collected in a
      java.util.List which is used as global:</p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">java</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">util</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_type">List</span><!-- <br/> --><span class="java_plain">&nbsp;globalList&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;java</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">util</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_type">ArrayList</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">Map</span><span class="java_plain">&nbsp;map&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">HashMap</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">map</span><span class="java_separator">.</span><span class="java_plain">put</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;list&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;globalList&nbsp;</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">Open</span><span class="java_plain">&nbsp;a&nbsp;stateless&nbsp;</span><span class="java_type">Session</span>
<!--  --><br/><span class="java_type">StatelessRuleSession</span><span class="java_plain">&nbsp;srs&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_separator">(</span><span class="java_type">StatelessRuleSession</span><span class="java_separator">)</span><span class="java_plain">&nbsp;runtime</span><span class="java_separator">.</span><span class="java_plain">createRuleSession</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;SistersRules&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">RuleRuntime</span><span class="java_separator">.</span><span class="java_plain">STATELESS_SESSION_TYPE&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Persons</span><span class="java_plain">&nbsp;added&nbsp;to&nbsp;</span><span class="java_type">List</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;call&nbsp;executeRules</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;giving&nbsp;a&nbsp;</span><span class="java_type">List</span><span class="java_plain">&nbsp;of&nbsp;</span><span class="java_type">Objects</span><span class="java_plain">&nbsp;as&nbsp;parameter</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">There</span><span class="java_plain">&nbsp;are&nbsp;rules&nbsp;which&nbsp;will&nbsp;put&nbsp;</span><span class="java_type">Objects</span><span class="java_plain">&nbsp;in&nbsp;the&nbsp;</span><span class="java_type">List</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;fetch&nbsp;the&nbsp;list&nbsp;from&nbsp;the&nbsp;map</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;list&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">List</span><span class="java_separator">)</span><span class="java_plain">&nbsp;map</span><span class="java_separator">.</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_literal">&quot;list&quot;</span><span class="java_separator">);</span></pre><p>Do not forget to declare the global "list" in your DRL:</p><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">package SistersRules; 
import org.drools.jsr94.rules.Person; 
global java.util.List list
rule FindSisters 
when 
    $person1 : Person ( $name1:name ) 
    $person2 : Person ( $name2:name ) 
    eval( $person1.hasSister($person2) ) 
then 
    list.add($person1.getName() + " and " + $person2.getName() +" are sisters"); 
    assert( $person1.getName() + " and " + $person2.getName() +" are sisters"); 
end</pre></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e8234"/>5.3. References</h2></div></div></div><p>If you need more information on JSR 94, please refer to the following
  references </p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p>Official JCP Specification for Java Rule Engine API (JSR
        94)</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://www.jcp.org/en/jsr/detail?id=94">http://www.jcp.org/en/jsr/detail?id=94</a></p></li></ul></div></li><li><p>The Java Rule Engine API documentation</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://www.javarules.org/api_doc/api/index.html">http://www.javarules.org/api_doc/api/index.html</a></p></li></ul></div></li><li><p>The Logic From The Bottom Line: An Introduction to The Drools
        Project. By N. Alex Rupp, published on TheServiceSide.com in
        2004</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://www.theserverside.com/articles/article.tss?l=Drools">http://www.theserverside.com/articles/article.tss?l=Drools</a></p></li></ul></div></li><li><p>Getting Started With the Java Rule Engine API (JSR 94): Toward
        Rule-Based Applications. By Dr. Qusay H. Mahmoud, published on Sun
        Developer Network in 2005</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://java.sun.com/developer/technicalArticles/J2SE/JavaRule.html">http://java.sun.com/developer/technicalArticles/J2SE/JavaRule.html</a></p></li></ul></div></li><li><p>Jess and the javax.rules API. By Ernest Friedman-Hill, published
        on TheServerSide.com in 2003</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://www.theserverside.com/articles/article.tss?l=Jess">http://www.theserverside.com/articles/article.tss?l=Jess</a></p></li></ul></div></li></ol></div></div></div><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="ch04.html"><strong>Prev</strong>Chapter 4. Rule Language Reference</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="ch06.html"><strong>Next</strong>Chapter 6. The Rule IDE (Eclipse)</a></li></ul></body></html>